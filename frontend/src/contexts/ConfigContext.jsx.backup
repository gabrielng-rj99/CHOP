/*
 * Client Hub Open Project
 * Copyright (C) 2025 Client Hub Contributors
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published
 * by the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

import React, { createContext, useContext, useState, useEffect } from "react";

const ConfigContext = createContext();

export const useConfig = () => {
    const context = useContext(ConfigContext);
    if (!context) {
        throw new Error("useConfig must be used within a ConfigProvider");
    }
    return context;
};

// 50 Theme Presets organized by color wheel position
export const THEME_PRESETS = {
    // ═══════════════════════════════════════════════════════════════════════════
    // DEFAULT - Oceano Profundo (Enhanced Deep Ocean - Project Default)
    // ═══════════════════════════════════════════════════════════════════════════
    default: {
        name: "Oceano Profundo",
        light: {
            primary: "#0284c7",
            secondary: "#0369a1",
            background: "#f0f9ff",
            surface: "#ffffff",
            text: "#0c4a6e",
            textSecondary: "#475569",
            border: "#7dd3fc",
        },
        dark: {
            primary: "#38bdf8",
            secondary: "#0ea5e9",
            background: "#0c1929",
            surface: "#0f2942",
            text: "#e0f2fe",
            textSecondary: "#7dd3fc",
            border: "#075985",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 1. AZUL (Blue) - Position 1 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    sapphire: {
        name: "Safira",
        light: {
            primary: "#1e40af",
            secondary: "#3730a3",
            background: "#eff6ff",
            surface: "#ffffff",
            text: "#1e3a5f",
            textSecondary: "#475569",
            border: "#93c5fd",
        },
        dark: {
            primary: "#3b82f6",
            secondary: "#6366f1",
            background: "#0f172a",
            surface: "#1e293b",
            text: "#e0f2fe",
            textSecondary: "#93c5fd",
            border: "#1e40af",
        },
    },
    steel: {
        name: "Aço",
        light: {
            primary: "#475569",
            secondary: "#1e40af",
            background: "#f8fafc",
            surface: "#ffffff",
            text: "#1e293b",
            textSecondary: "#475569",
            border: "#cbd5e1",
        },
        dark: {
            primary: "#94a3b8",
            secondary: "#60a5fa",
            background: "#0f172a",
            surface: "#1e293b",
            text: "#f1f5f9",
            textSecondary: "#cbd5e1",
            border: "#334155",
        },
    },
    winter: {
        name: "Inverno",
        light: {
            primary: "#0ea5e9",
            secondary: "#06b6d4",
            background: "#e0f2fe",
            surface: "#ffffff",
            text: "#164e63",
            textSecondary: "#0369a1",
            border: "#7dd3fc",
        },
        dark: {
            primary: "#38bdf8",
            secondary: "#22d3ee",
            background: "#082f49",
            surface: "#0c4a6e",
            text: "#e0f2fe",
            textSecondary: "#7dd3fc",
            border: "#0284c7",
        },
    },
    arcade: {
        name: "Arcade",
        light: {
            primary: "#2563eb",
            secondary: "#7c3aed",
            background: "#eef2ff",
            surface: "#ffffff",
            text: "#312e81",
            textSecondary: "#4338ca",
            border: "#a5b4fc",
        },
        dark: {
            primary: "#818cf8",
            secondary: "#a78bfa",
            background: "#0f0f23",
            surface: "#1a1a3e",
            text: "#c7d2fe",
            textSecondary: "#a5b4fc",
            border: "#4f46e5",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 2. CYAN - Position 2 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    teal: {
        name: "Azul Petróleo",
        light: {
            primary: "#0d9488",
            secondary: "#14b8a6",
            background: "#f0fdfa",
            surface: "#ffffff",
            text: "#134e4a",
            textSecondary: "#115e59",
            border: "#5eead4",
        },
        dark: {
            primary: "#14b8a6",
            secondary: "#2dd4bf",
            background: "#042f2e",
            surface: "#134e4a",
            text: "#ccfbf1",
            textSecondary: "#5eead4",
            border: "#0d9488",
        },
    },
    arctic: {
        name: "Ártico",
        light: {
            primary: "#0891b2",
            secondary: "#06b6d4",
            background: "#cffafe",
            surface: "#ffffff",
            text: "#164e63",
            textSecondary: "#155e75",
            border: "#67e8f9",
        },
        dark: {
            primary: "#22d3ee",
            secondary: "#06b6d4",
            background: "#083344",
            surface: "#0c4f5e",
            text: "#cffafe",
            textSecondary: "#67e8f9",
            border: "#0891b2",
        },
    },
    aqua: {
        name: "Aqua",
        light: {
            primary: "#0891b2",
            secondary: "#14b8a6",
            background: "#e0f2fe",
            surface: "#ffffff",
            text: "#0c4a6e",
            textSecondary: "#134e4a",
            border: "#7dd3fc",
        },
        dark: {
            primary: "#06b6d4",
            secondary: "#14b8a6",
            background: "#05181f",
            surface: "#0a2e3a",
            text: "#a5f3fc",
            textSecondary: "#5eead4",
            border: "#0e7490",
        },
    },
    mermaid: {
        name: "Sereia",
        light: {
            primary: "#0d9488",
            secondary: "#ec4899",
            background: "#ecfeff",
            surface: "#ffffff",
            text: "#134e4a",
            textSecondary: "#9d174d",
            border: "#5eead4",
        },
        dark: {
            primary: "#2dd4bf",
            secondary: "#f472b6",
            background: "#042f2e",
            surface: "#0f3d3c",
            text: "#ccfbf1",
            textSecondary: "#f9a8d4",
            border: "#0f766e",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 3. VERDE (Green) - Position 3 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    lime: {
        name: "Limão",
        light: {
            primary: "#84cc16",
            secondary: "#65a30d",
            background: "#f7fee7",
            surface: "#ffffff",
            text: "#365314",
            textSecondary: "#4d7c0f",
            border: "#bef264",
        },
        dark: {
            primary: "#a3e635",
            secondary: "#84cc16",
            background: "#1a2e05",
            surface: "#263f09",
            text: "#ecfccb",
            textSecondary: "#bef264",
            border: "#4d7c0f",
        },
    },
    forest: {
        name: "Floresta",
        light: {
            primary: "#16a34a",
            secondary: "#0d9488",
            background: "#f0fdf4",
            surface: "#ffffff",
            text: "#14532d",
            textSecondary: "#166534",
            border: "#86efac",
        },
        dark: {
            primary: "#4ade80",
            secondary: "#2dd4bf",
            background: "#052e16",
            surface: "#14532d",
            text: "#dcfce7",
            textSecondary: "#86efac",
            border: "#15803d",
        },
    },
    emerald: {
        name: "Esmeralda",
        light: {
            primary: "#10b981",
            secondary: "#059669",
            background: "#ecfdf5",
            surface: "#ffffff",
            text: "#064e3b",
            textSecondary: "#047857",
            border: "#6ee7b7",
        },
        dark: {
            primary: "#10b981",
            secondary: "#34d399",
            background: "#022c22",
            surface: "#064e3b",
            text: "#d1fae5",
            textSecondary: "#a7f3d0",
            border: "#059669",
        },
    },
    matrix: {
        name: "Matrix",
        light: {
            primary: "#22c55e",
            secondary: "#16a34a",
            background: "#f0fdf4",
            surface: "#ffffff",
            text: "#14532d",
            textSecondary: "#166534",
            border: "#86efac",
        },
        dark: {
            primary: "#00ff00",
            secondary: "#22c55e",
            background: "#000a00",
            surface: "#001a00",
            text: "#00ff00",
            textSecondary: "#4ade80",
            border: "#166534",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 4. AMARELO ESVERDEADO (Yellow-Green) - Position 4 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    aurora: {
        name: "Aurora",
        light: {
            primary: "#22c55e",
            secondary: "#f472b6",
            background: "#f0fdf4",
            surface: "#ffffff",
            text: "#14532d",
            textSecondary: "#be185d",
            border: "#bbf7d0",
        },
        dark: {
            primary: "#4ade80",
            secondary: "#f9a8d4",
            background: "#052e16",
            surface: "#14532d",
            text: "#dcfce7",
            textSecondary: "#fbcfe8",
            border: "#15803d",
        },
    },
    spring: {
        name: "Primavera",
        light: {
            primary: "#fbbf24",
            secondary: "#ec4899",
            background: "#fffbeb",
            surface: "#ffffff",
            text: "#78350f",
            textSecondary: "#9d174d",
            border: "#fde68a",
        },
        dark: {
            primary: "#fcd34d",
            secondary: "#f472b6",
            background: "#1c1505",
            surface: "#2d250a",
            text: "#fef3c7",
            textSecondary: "#f9a8d4",
            border: "#ca8a04",
        },
    },
    mint: {
        name: "Menta",
        light: {
            primary: "#10b981",
            secondary: "#06b6d4",
            background: "#ecfdf5",
            surface: "#ffffff",
            text: "#064e3b",
            textSecondary: "#0e7490",
            border: "#a7f3d0",
        },
        dark: {
            primary: "#34d399",
            secondary: "#22d3ee",
            background: "#022c22",
            surface: "#064e3b",
            text: "#d1fae5",
            textSecondary: "#67e8f9",
            border: "#059669",
        },
    },
    zen: {
        name: "Zen",
        light: {
            primary: "#059669",
            secondary: "#78716c",
            background: "#ecfdf5",
            surface: "#ffffff",
            text: "#064e3b",
            textSecondary: "#57534e",
            border: "#a7f3d0",
        },
        dark: {
            primary: "#34d399",
            secondary: "#a8a29e",
            background: "#022c22",
            surface: "#064e3b",
            text: "#d1fae5",
            textSecondary: "#d6d3d1",
            border: "#047857",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 5. AMARELO (Yellow) - Position 5 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    gold: {
        name: "Ouro",
        light: {
            primary: "#eab308",
            secondary: "#f59e0b",
            background: "#fefce8",
            surface: "#ffffff",
            text: "#713f12",
            textSecondary: "#78350f",
            border: "#fde047",
        },
        dark: {
            primary: "#fde047",
            secondary: "#fbbf24",
            background: "#1c1a05",
            surface: "#332d0a",
            text: "#fef9c3",
            textSecondary: "#fde68a",
            border: "#a16207",
        },
    },
    sunflower: {
        name: "Girassol",
        light: {
            primary: "#eab308",
            secondary: "#65a30d",
            background: "#fefce8",
            surface: "#ffffff",
            text: "#713f12",
            textSecondary: "#4d7c0f",
            border: "#fde047",
        },
        dark: {
            primary: "#facc15",
            secondary: "#84cc16",
            background: "#1c1a05",
            surface: "#2d2a0a",
            text: "#fef9c3",
            textSecondary: "#bef264",
            border: "#ca8a04",
        },
    },
    honey: {
        name: "Mel",
        light: {
            primary: "#f59e0b",
            secondary: "#d97706",
            background: "#fffbeb",
            surface: "#ffffff",
            text: "#78350f",
            textSecondary: "#92400e",
            border: "#fcd34d",
        },
        dark: {
            primary: "#fbbf24",
            secondary: "#f59e0b",
            background: "#1c1505",
            surface: "#2d250a",
            text: "#fef3c7",
            textSecondary: "#fde68a",
            border: "#b45309",
        },
    },
    bee: {
        name: "Abelha",
        light: {
            primary: "#eab308",
            secondary: "#1f2937",
            background: "#fefce8",
            surface: "#ffffff",
            text: "#1f2937",
            textSecondary: "#4b5563",
            border: "#fde047",
        },
        dark: {
            primary: "#facc15",
            secondary: "#6b7280",
            background: "#1a1a0a",
            surface: "#2d2d1a",
            text: "#fef3c7",
            textSecondary: "#d1d5db",
            border: "#ca8a04",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 6. AMARELO ALARANJADO (Yellow-Orange) - Position 6 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    sunset: {
        name: "Pôr do Sol",
        light: {
            primary: "#f59e0b",
            secondary: "#dc2626",
            background: "#fffbeb",
            surface: "#ffffff",
            text: "#78350f",
            textSecondary: "#991b1b",
            border: "#fcd34d",
        },
        dark: {
            primary: "#fbbf24",
            secondary: "#ef4444",
            background: "#1c1505",
            surface: "#2d250a",
            text: "#fef3c7",
            textSecondary: "#fca5a5",
            border: "#d97706",
        },
    },
    beach: {
        name: "Praia",
        light: {
            primary: "#b58900",
            secondary: "#268bd2",
            background: "#fdf6e3",
            surface: "#eee8d5",
            text: "#657b83",
            textSecondary: "#93a1a1",
            border: "#d4a574",
        },
        dark: {
            primary: "#b58900",
            secondary: "#268bd2",
            background: "#002b36",
            surface: "#073642",
            text: "#839496",
            textSecondary: "#657b83",
            border: "#586e75",
        },
    },
    amber: {
        name: "Âmbar",
        light: {
            primary: "#f59e0b",
            secondary: "#d97706",
            background: "#fffbeb",
            surface: "#ffffff",
            text: "#78350f",
            textSecondary: "#92400e",
            border: "#fcd34d",
        },
        dark: {
            primary: "#fbbf24",
            secondary: "#f59e0b",
            background: "#1c1505",
            surface: "#2d250a",
            text: "#fef3c7",
            textSecondary: "#fde68a",
            border: "#b45309",
        },
    },
    solarized: {
        name: "Solarized",
        light: {
            primary: "#268bd2",
            secondary: "#2aa198",
            background: "#fdf6e3",
            surface: "#eee8d5",
            text: "#586e75",
            textSecondary: "#657b83",
            border: "#93a1a1",
        },
        dark: {
            primary: "#268bd2",
            secondary: "#2aa198",
            background: "#002b36",
            surface: "#073642",
            text: "#93a1a1",
            textSecondary: "#839496",
            border: "#586e75",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 7. LARANJA (Orange) - Position 7 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    summer: {
        name: "Verão",
        light: {
            primary: "#f97316",
            secondary: "#0891b2",
            background: "#fff7ed",
            surface: "#ffffff",
            text: "#7c2d12",
            textSecondary: "#155e75",
            border: "#fdba74",
        },
        dark: {
            primary: "#fb923c",
            secondary: "#22d3ee",
            background: "#1c1305",
            surface: "#2d250a",
            text: "#ffedd5",
            textSecondary: "#67e8f9",
            border: "#c2410c",
        },
    },
    fiery_ocean: {
        name: "Oceano Flamejante",
        light: {
            primary: "#0891b2",
            secondary: "#ea580c",
            background: "#ecfeff",
            surface: "#ffffff",
            text: "#155e75",
            textSecondary: "#9a3412",
            border: "#67e8f9",
        },
        dark: {
            primary: "#22d3ee",
            secondary: "#f97316",
            background: "#083344",
            surface: "#0c4f5e",
            text: "#cffafe",
            textSecondary: "#fdba74",
            border: "#0891b2",
        },
    },
    tiger: {
        name: "Tigre",
        light: {
            primary: "#f97316",
            secondary: "#1f2937",
            background: "#fff7ed",
            surface: "#ffffff",
            text: "#7c2d12",
            textSecondary: "#1f2937",
            border: "#fdba74",
        },
        dark: {
            primary: "#fb923c",
            secondary: "#f59e0b",
            background: "#1a0f05",
            surface: "#2d1a0a",
            text: "#ffedd5",
            textSecondary: "#fde68a",
            border: "#ea580c",
        },
    },
    pumpkin: {
        name: "Abóbora",
        light: {
            primary: "#ea580c",
            secondary: "#7c3aed",
            background: "#fff7ed",
            surface: "#ffffff",
            text: "#7c2d12",
            textSecondary: "#5b21b6",
            border: "#fed7aa",
        },
        dark: {
            primary: "#f97316",
            secondary: "#a78bfa",
            background: "#1a0f05",
            surface: "#2d1a0f",
            text: "#ffedd5",
            textSecondary: "#c4b5fd",
            border: "#c2410c",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 8. LARANJA AVERMELHADO (Red-Orange) - Position 8 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    autumn: {
        name: "Outono",
        light: {
            primary: "#c2410c",
            secondary: "#b45309",
            background: "#fff7ed",
            surface: "#ffffff",
            text: "#7c2d12",
            textSecondary: "#78350f",
            border: "#fed7aa",
        },
        dark: {
            primary: "#ea580c",
            secondary: "#d97706",
            background: "#1c0f05",
            surface: "#2d1a0a",
            text: "#ffedd5",
            textSecondary: "#fde68a",
            border: "#9a3412",
        },
    },
    earthy: {
        name: "Terroso",
        light: {
            primary: "#a16207",
            secondary: "#16a34a",
            background: "#fffbeb",
            surface: "#ffffff",
            text: "#713f12",
            textSecondary: "#166534",
            border: "#fde68
a",
        },
        dark: {
            primary: "#ca8a04",
            secondary: "#22c55e",
            background: "#1c1505",
            surface: "#2d250a",
            text: "#fef9c3",
            textSecondary: "#86efac",
            border: "#92400e",
        },
    },
    terracotta: {
        name: "Terracota",
        light: {
            primary: "#b45309",
            secondary: "#78716c",
            background: "#fffbeb",
            surface: "#ffffff",
            text: "#78350f",
            textSecondary: "#57534e",
            border: "#fcd34d",
        },
        dark: {
            primary: "#d97706",
            secondary: "#a8a29e",
            background: "#1a1005",
            surface: "#2d1a0a",
            text: "#fef3c7",
            textSecondary: "#d6d3d1",
            border: "#92400e",
        },
    },
    volcanic: {
        name: "Vulcânico",
        light: {
            primary: "#dc2626",
            secondary: "#ea580c",
            background: "#fef2f2",
            surface: "#ffffff",
            text: "#7f1d1d",
            textSecondary: "#9a3412",
            border: "#fecaca",
        },
        dark: {
            primary: "#ef4444",
            secondary: "#f97316",
            background: "#1f0505",
            surface: "#3d0a0a",
            text: "#fef2f2",
            textSecondary: "#fdba74",
            border: "#b91c1c",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 9. VERMELHO (Red) - Position 9 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    ruby: {
        name: "Rubi",
        light: {
            primary: "#b91c1c",
            secondary: "#991b1b",
            background: "#fef2f2",
            surface: "#ffffff",
            text: "#7f1d1d",
            textSecondary: "#450a0a",
            border: "#fecaca",
        },
        dark: {
            primary: "#dc2626",
            secondary: "#ef4444",
            background: "#1a0505",
            surface: "#2d0a0a",
            text: "#fef2f2",
            textSecondary: "#fca5a5",
            border: "#7f1d1d",
        },
    },
    berry: {
        name: "Frutas Vermelhas",
        light: {
            primary: "#c41e3a",
            secondary: "#8b0000",
            background: "#fff0f3",
            surface: "#ffffff",
            text: "#333333",
            textSecondary: "#666666",
            border: "#ffb3ba",
        },
        dark: {
            primary: "#ff6b7a",
            secondary: "#c41e3a",
            background: "#2d0a0e",
            surface: "#4d1618",
            text: "#f7fafc",
            textSecondary: "#a0aec0",
            border: "#8b0000",
        },
    },
    scarlet: {
        name: "Escarlate",
        light: {
            primary: "#dc2626",
            secondary: "#be123c",
            background: "#fef2f2",
            surface: "#ffffff",
            text: "#7f1d1d",
            textSecondary: "#9f1239",
            border: "#fecaca",
        },
        dark: {
            primary: "#f43f5e",
            secondary: "#fb7185",
            background: "#1f0505",
            surface: "#3d0a0a",
            text: "#fef2f2",
            textSecondary: "#fda4af",
            border: "#be123c",
        },
    },
    dragon: {
        name: "Dragão",
        light: {
            primary: "#dc2626",
            secondary: "#eab308",
            background: "#fef2f2",
            surface: "#ffffff",
            text: "#7f1d1d",
            textSecondary: "#854d0e",
            border: "#fecaca",
        },
        dark: {
            primary: "#ef4444",
            secondary: "#facc15",
            background: "#1f0505",
            surface: "#3d0a0a",
            text: "#fef2f2",
            textSecondary: "#fde047",
            border: "#991b1b",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 10. ROXO AVERMELHADO (Red-Purple) - Position 10 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    monokai: {
        name: "Monokai",
        light: {
            primary: "#f92672",
            secondary: "#a6e22e",
            background: "#faf8f5",
            surface: "#ffffff",
            text: "#3e3d32",
            textSecondary: "#75715e",
            border: "#e8e5de",
        },
        dark: {
            primary: "#f92672",
            secondary: "#a6e22e",
            background: "#272822",
            surface: "#3e3d32",
            text: "#f8f8f2",
            textSecondary: "#75715e",
            border: "#49483e",
        },
    },
    pink: {
        name: "Rosa",
        light: {
            primary: "#ec4899",
            secondary: "#db2777",
            background: "#fdf2f8",
            surface: "#ffffff",
            text: "#831843",
            textSecondary: "#9d174d",
            border: "#f9a8d4",
        },
        dark: {
            primary: "#f472b6",
            secondary: "#ec4899",
            background: "#1f0516",
            surface: "#3d0a26",
            text: "#fce7f3",
            textSecondary: "#f9a8d4",
            border: "#be185d",
        },
    },
    candy: {
        name: "Doce",
        light: {
            primary: "#ec4899",
            secondary: "#3b82f6",
            background: "#fdf2f8",
            surface: "#ffffff",
            text: "#333333",
            textSecondary: "#666666",
            border: "#f9a8d4",
        },
        dark: {
            primary: "#f472b6",
            secondary: "#60a5fa",
            background: "#1f0f18",
            surface: "#3d1a2e",
            text: "#f7fafc",
            textSecondary: "#a0aec0",
            border: "#9d174d",
        },
    },
    neon_city: {
        name: "Cidade Neon",
        light: {
            primary: "#ec4899",
            secondary: "#8b5cf6",
            background: "#fdf2f8",
            surface: "#ffffff",
            text: "#831843",
            textSecondary: "#5b21b6",
            border: "#f9a8d4",
        },
        dark: {
            primary: "#ff1744",
            secondary: "#ffea00",
            background: "#0a0a0a",
            surface: "#1a1a1a",
            text: "#00e5ff",
            textSecondary: "#ffea00",
            border: "#ff1744",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 11. ROXO (Purple) - Position 11 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    royal: {
        name: "Real",
        light: {
            primary: "#6d28d9",
            secondary: "#7c3aed",
            background: "#faf5ff",
            surface: "#ffffff",
            text: "#4c1d95",
            textSecondary: "#5b21b6",
            border: "#c4b5fd",
        },
        dark: {
            primary: "#8b5cf6",
            secondary: "#a78bfa",
            background: "#1a0f2e",
            surface: "#2d1a50",
            text: "#ede9fe",
            textSecondary: "#c4b5fd",
            border: "#5b21b6",
        },
    },
    lavender: {
        name: "Lavanda",
        light: {
            primary: "#a855f7",
            secondary: "#c084fc",
            background: "#faf5ff",
            surface: "#ffffff",
            text: "#6b21a8",
            textSecondary: "#7e22ce",
            border: "#d8b4fe",
        },
        dark: {
            primary: "#a855f7",
            secondary: "#c084fc",
            background: "#1e1232",
            surface: "#321e50",
            text: "#1f2937",
            textSecondary: "#4b5563",
            border: "#7e22ce",
        },
    },
    amethyst: {
        name: "Ametista",
        light: {
            primary: "#8b5cf6",
            secondary: "#7c3aed",
            background: "#f5f3ff",
            surface: "#ffffff",
            text: "#5b21b6",
            textSecondary: "#6d28d9",
            border: "#c4b5fd",
        },
        dark: {
            primary: "#a78bfa",
            secondary: "#8b5cf6",
            background: "#0f0a1f",
            surface: "#1e1535",
            text: "#ede9fe",
            textSecondary: "#c4b5fd",
            border: "#6d28d9",
        },
    },
    grape: {
        name: "Uva",
        light: {
            primary: "#7c3aed",
            secondary: "#16a34a",
            background: "#f5f3ff",
            surface: "#ffffff",
            text: "#4c1d95",
            textSecondary: "#166534",
            border: "#c4b5fd",
        },
        dark: {
            primary: "#a78bfa",
            secondary: "#4ade80",
            background: "#1a1025",
            surface: "#2d1640",
            text: "#ede9fe",
            textSecondary: "#86efac",
            border: "#5b21b6",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // 12. ROXO AZULADO (Blue-Purple) - Position 12 on Color Wheel
    // ═══════════════════════════════════════════════════════════════════════════
    midnight: {
        name: "Meia-Noite",
        light: {
            primary: "#6366f1",
            secondary: "#4f46e5",
            background: "#eef2ff",
            surface: "#ffffff",
            text: "#312e81",
            textSecondary: "#3730a3",
            border: "#a5b4fc",
        },
        dark: {
            primary: "#818cf8",
            secondary: "#6366f1",
            background: "#0f0f1f",
            surface: "#1e1e3f",
            text: "#e0e7ff",
            textSecondary: "#a5b4fc",
            border: "#3730a3",
        },
    },
    cosmic: {
        name: "Cósmico",
        light: {
            primary: "#4f46e5",
            secondary: "#8b5cf6",
            background: "#eef2ff",
            surface: "#ffffff",
            text: "#312e81",
            textSecondary: "#5b21b6",
            border: "#a5b4fc",
        },
        dark: {
            primary: "#6366f1",
            secondary: "#a78bfa",
            background: "#0a0520",
            surface: "#1a1040",
            text: "#c7d2fe",
            textSecondary: "#d8b4fe",
            border: "#4338ca",
        },
    },
    galaxy: {
        name: "Galáxia",
        light: {
            primary: "#6366f1",
            secondary: "#ec4899",
            background: "#eef2ff",
            surface: "#ffffff",
            text: "#312e81",
            textSecondary: "#9d174d",
            border: "#a5b4fc",
        },
        dark: {
            primary: "#8b5cf6",
            secondary: "#f472b6",
            background: "#0f0a1f",
            surface: "#1e153a",
            text: "#ddd6fe",
            textSecondary: "#f9a8d4",
            border: "#6d28d9",
        },
    },
    synthwave: {
        name: "Synthwave",
        light: {
            primary: "#ec4899",
            secondary: "#06b6d4",
            background: "#fdf2f8",
            surface: "#ffffff",
            text: "#831843",
            textSecondary: "#155e75",
            border: "#f9a8d4",
        },
        dark: {
            primary: "#ff006e",
            secondary: "#00f5ff",
            background: "#1a0a2e",
            surface: "#2d1052",
            text: "#ff71ce",
            textSecondary: "#01cdfe",
            border: "#b967ff",
        },
    },

    // ═══════════════════════════════════════════════════════════════════════════
    // BONUS: Additional Popular Themes (Complementary Color Schemes)
    // ═══════════════════════════════════════════════════════════════════════════
    blue_orange: {
        name: "Azul e Laranja",
        light: {
            primary: "#2563eb",
            secondary: "#ea580c",
            background: "#eff6ff",
            surface: "#ffffff",
            text: "#1e40af",
            textSecondary: "#9a3412",
            border: "#93c5fd",
        },
        dark: {
            primary: "#3b82f6",
            secondary: "#f97316",
            background: "#0f172a",
            surface: "#1e293b",
            text: "#dbeafe",
            textSecondary: "#fdba74",
            border: "#1d4ed8",
        },
    },
    red_green: {
        name: "Vermelho e Verde",
        light: {
            primary: "#dc2626",
            secondary: "#16a34a",
            background: "#fef2f2",
            surface: "#ffffff",
            text: "#991b1b",
            textSecondary: "#166534",
            border: "#fecaca",
        },
        dark: {
            primary: "#ef4444",
            secondary: "#22c55e",
            background: "#1f0505",
            surface: "#2d0f0f",
            text: "#fef2f2",
            textSecondary: "#86efac",
            border: "#b91c1c",
        },
    },
    purple_yellow: {
        name: "Roxo e Amarelo",
        light: {
            primary: "#7c3aed",
            secondary: "#ca8a04",
            background: "#faf5ff",
            surface: "#ffffff",
            text: "#5b21b6",
            textSecondary: "#854d0e",
            border: "#c4b5fd",
        },
        dark: {
            primary: "#a78bfa",
            secondary: "#facc15",
            background: "#1a1025",
            surface: "#2d1640",
            text: "#ede9fe",
            textSecondary: "#fde047",
            border: "#6d28d9",
        },
    },
    neon: {
        name: "Neon",
        light: {
            primary: "#ec4899",
            secondary: "#06b6d4",
            background: "#fdf2f8",
            surface: "#ffffff",
            text: "#831843",
            textSecondary: "#155e75",
            border: "#f9a8d4",
        },
        dark: {
            primary: "#ff00ff",
            secondary: "#00ffff",
            background: "#000000",
            surface: "#0a0a0a",
            text: "#00ff00",
            textSecondary: "#ffff00",
            border: "#ff00ff",
        },
    },
    pastel: {
        name: "Pastel",
        light: {
            primary: "#fbbf24",
            secondary: "#f472b6",
            background: "#fefce8",
            surface: "#ffffff",
            text: "#333333",
            textSecondary: "#666666",
            border: "#fde68a",
        },
        dark: {
            primary: "#fcd34d",
            secondary: "#f9a8d4",
            background: "#1f1a0f",
            surface: "#3d3019",
            text: "#f7fafc",
            textSecondary: "#a0aec0",
            border: "#92400e",
        },
    },
    pastel_ocean: {
        name: "Pastel Oceano",
        light: {
            primary: "#67e8f9",
            secondary: "#a5b4fc",
            background: "#ecfeff",
            surface: "#ffffff",
            text: "#155e75",
            textSecondary: "#3730a3",
            border: "#a5f3fc",
        },
        dark: {
            primary: "#22d3ee",
            secondary: "#818cf8",
            background: "#083344",
            surface: "#0c4a6e",
            text: "#cffafe",
            textSecondary: "#c7d2fe",
            border: "#0891b2",
        },
    },
};

// High Contrast Themes for Accessibility
const HIGH_CONTRAST_LIGHT = {
    primary: "#000000",
    secondary: "#0000ff",
    background: "#ffffff",
    surface: "#ffffff",
    text: "#000000",
    textSecondary: "#000000",
    border: "#000000",
};

const HIGH_CONTRAST_DARK = {
    primary: "#ffff00",
    secondary: "#00ffff",
    background: "#000000",
    surface: "#000000",
    text: "#fff",
    textSecondary: "#fff",
    border: "#fff",
};

// Colorblind-Safe Palettes
const COLORBLIND_SAFE = {
    protanopia: {
        light: {
            primary: "#0077bb",
            secondary: "#33bbee",
            background: "#f0f9ff",
            surface: "#ffffff",
            text: "#0c4a6e",
            textSecondary: "#0e7490",
            border: "#7dd3fc",
        },
        dark: {
            primary: "#33bbee",
            secondary: "#0077bb",
            background: "#0c1929",
            surface: "#0f2942",
            text: "#e0f2fe",
            textSecondary: "#7dd3fc",
            border: "#075985",
        },
    },
    deuteranopia: {
        light: {
            primary: "#0077bb",
            secondary: "#ee7733",
            background: "#f0f9ff",
            surface: "#ffffff",
            text: "#0c4a6e",
            textSecondary: "#7c2d12",
            border: "#7dd3fc",
        },
        dark: {
            primary: "#33bbee",
            secondary: "#ee7733",
            background: "#0c1929",
            surface: "#0f2942",
            text: "#e0f2fe",
            textSecondary: "#fdba74",
            border: "#075985",
        },
    },
    tritanopia: {
        light: {
            primary: "#ee3377",
            secondary: "#009988",
            background: "#fef2f8",
            surface: "#ffffff",
            text: "#831843",
            textSecondary: "#134e4a",
            border: "#f9a8d4",
        },
        dark: {
            primary: "#ee3377",
            secondary: "#009988",
            background: "#1f0516",
            surface: "#3d0a26",
            text: "#fce7f3",
            textSecondary: "#5eead4",
            border: "#be185d",
        },
    },
};

// Default Settings
const defaultSettings = {
    branding: {
        appName: "Client Hub",
        logoUrl:
            "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40'%3E%3Crect fill='%233498db' width='40' height='40'/%3E%3C/svg%3E",
        minimizedIconUrl:
            "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Crect fill='%233498db' width='32' height='32'/%3E%3C/svg%3E",
        logoWideUrl: "",
        logoSquareUrl: "",
        useCustomLogo: false,
    },
    labels: {
        client: "Cliente",
        client_gender: "M",
        clients: "Clientes",
        agreement: "Contrato",
        agreement_gender: "M",
        agreements: "Contratos",
        category: "Categoria",
        category_gender: "F",
        categories: "Categorias",
        subcategory: "Subcategoria",
        subcategory_gender: "F",
        subcategories: "Subcategorias",
        affiliate: "Affiliatee",
        affiliate_gender: "M",
        affiliates: "Affiliatees",
        user: "Usuário",
        user_gender: "M",
        users: "Usuários",
    },
    theme: {
        mode: "system",
        preset: "default",
        primaryColor: "#0284c7",
        secondaryColor: "#0369a1",
        backgroundColor: "#f0f9ff",
        surfaceColor: "#ffffff",
        textColor: "#0c4a6e",
        textSecondaryColor: "#475569",
        borderColor: "#7dd3fc",
    },
};

// Default label definitions
const defaultLabels = {
    client: "Cliente",
    client_gender: "M",
    clients: "Clientes",
    agreement: "Contrato",
    agreement_gender: "M",
    agreements: "Contratos",
    category: "Categoria",
    category_gender: "F",
    categories: "Categorias",
    subcategory: "Subcategoria",
    subcategory_gender: "F",
    subcategories: "Subcategorias",
    affiliate: "Affiliatee",
    affiliate_gender: "M",
    affiliates: "Affiliatees",
    user: "Usuário",
    user_gender: "M",
    users: "Usuários",
};

export const ConfigProvider = ({ children }) => {
    const [config, setConfig] = useState(defaultSettings);
    const [loading, setLoading] = useState(true);

    // Fetch settings from API
    const fetchSettings = async () => {
        const token = localStorage.getItem("accessToken");
        if (!token) {
            setLoading(false);
            return;
        }
        try {
            const res = await fetch("/api/settings", {
                headers: {
                    Authorization: `Bearer ${token}`,
                },
            });
            if (!res.ok) throw new Error("Fetch settings error");

            const data = await res.json();

            const newConfig = { ...defaultSettings };

            for (const item of data) {
                const parts = item.key.split(".");
                let obj = newConfig;

                for (let i = 0; i < parts.length - 1; i++) {
                    let val = parts[i];
                    if (!obj[val]) obj[val] = {};
                    obj = obj[val];
                }
                obj[parts[parts.length - 1]] = item.value;
            }

            setConfig(newConfig);
        } catch (err) {
            console.error("Error fetching settings:", err);
        } finally {
            setLoading(false);
        }
    };

    // Load default accessibility preferences from localStorage
    const defaultAccessibility = {
        highContrast: localStorage.getItem("highContrast") === "true",
        colorBlindMode: localStorage.getItem("colorBlindMode") || "none",
    };

    // Theme mode state (light/dark/system) - stored per-user in localStorage
    const [themeMode, setThemeModeState] = useState(
        localStorage.getItem("themeMode") || "system",
    );

    // Accessibility state
    const [accessibility, setAccessibilityState] = useState(
        defaultAccessibility,
    );
    const [saved, setSaved] = useState(false);

    // Update theme mode
    const setThemeMode = (mode) => {
        setThemeModeState(mode);
        localStorage.setItem("themeMode", mode);
    };

    const setAccessibility = (prefs) => {
        const newPrefs = { ...accessibility, ...prefs };
        setAccessibilityState(newPrefs);
        localStorage.setItem("highContrast", newPrefs.highContrast);
        localStorage.setItem("colorBlindMode", newPrefs.colorBlindMode);
    };

    // Determine the actual mode to apply (light or dark)
    const [resolvedMode, setResolvedMode] = useState("light");

    // Check system preference
    const checkSystemTheme = () => {
        const prefersDark = window.matchMedia(
            "(prefers-color-scheme: dark)",
        ).matches;
        return prefersDark ? "dark" : "light";
    };

    const updateResolvedMode = () => {
        if (themeMode === "system") {
            setResolvedMode(checkSystemTheme());
        } else {
            setResolvedMode(themeMode);
        }
    };

    // Listen to theme mode changes
    useEffect(() => {
        updateResolvedMode();
        const mediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
        const handler = () => {
            if (themeMode === "system") {
                setResolvedMode(checkSystemTheme());
            }
        };
        mediaQuery.addEventListener("change", handler);
        return () => mediaQuery.removeEventListener("change", handler);
    }, [themeMode]);

    // Apply theme to document
    useEffect(() => {
        updateResolvedMode();
        const root = document.documentElement;

        const preset = config?.theme?.preset || "default";
        const primaryColor = config?.theme?.primaryColor;
        const secondaryColor = config?.theme?.secondaryColor;
        const backgroundColor = config?.theme?.backgroundColor;
        const surfaceColor = config?.theme?.surfaceColor;
        const textColor = config?.theme?.textColor;
        const textSecondaryColor = config?.theme?.textSecondaryColor;
        const borderColor = config?.theme?.borderColor;

        let themeColors;

        // Check for accessibility overrides first
        if (accessibility.highContrast) {
            themeColors =
                resolvedMode === "dark"
                    ? HIGH_CONTRAST_DARK
                    : HIGH_CONTRAST_LIGHT;
        } else if (
            accessibility.colorBlindMode &&
            accessibility.colorBlindMode !== "none"
        ) {
            const colorblindPalette =
                COLORBLIND_SAFE[accessibility.colorBlindMode];
            themeColors =
                resolvedMode === "dark"
                    ? colorblindPalette.dark
                    : colorblindPalette.light;
        } else if (preset === "custom") {
            // Custom theme - create distinct light/dark variants from custom colors
            const customLight = {
                primary: primaryColor || "#0284c7",
                secondary: secondaryColor || "#0369a1",
                background: backgroundColor || "#f0f9ff",
                surface: surfaceColor || "#ffffff",
                text: textColor || "#0c4a6e",
                textSecondary: textSecondaryColor || "#475569",
                border: borderColor || "#7dd3fc",
            };

            // Create a properly contrasted dark variant
            const customDark = {
                primary: lightenColor(primaryColor || "#0284c7", 15),
                secondary: lightenColor(secondaryColor || "#0369a1", 10),
                background: darkenColor(backgroundColor || "#f0f9ff", 85),
                surface: darkenColor(surfaceColor || "#ffffff", 75),
                text: "#e0f2fe",
                textSecondary: "#94a3b8",
                border: darkenColor(borderColor || "#7dd3fc", 40),
            };
            themeColors = resolvedMode === "dark" ? customDark : customLight;
        } else if (preset && THEME_PRESETS[preset]) {
            // Preset theme
            themeColors =
                resolvedMode === "dark"
                    ? THEME_PRESETS[preset].dark
                    : THEME_PRESETS[preset].light;
        } else {
            // Fallback to default
            themeColors =
                resolvedMode === "dark"
                    ? THEME_PRESETS.default.dark
                    : THEME_PRESETS.default.light;
        }

        // Helper to get brightness (simplified)
        const getBrightness = (hex) => {
            if (!hex) return 0;
            const c = hex.replace("#", "");
            if (c.length !== 6) return 0;
            const rgb = parseInt(c, 16);
            const r = (rgb >> 16) & 0xff;
            const g = (rgb >> 8) & 0xff;
            const b = (rgb >> 0) & 0xff;
            return 0.2126 * r + 0.7152 * g + 0.0722 * b;
        };

        // Determine text colors based on background brightness
        let primaryTextColor = "#ffffff";
        if (themeColors.primary && getBrightness(themeColors.primary) > 150) {
            primaryTextColor = "#000000";
        }

        let secondaryTextColor = "#ffffff";
        if (
            themeColors.secondary &&
            getBrightness(themeColors.secondary) > 150
        ) {
            secondaryTextColor = "#000000";
        }

        // Apply Mode Class
        if (resolvedMode === "dark") {
            root.classList.add("dark-mode");
            root.classList.remove("light-mode");
        } else {
            root.classList.add("light-mode");
            root.classList.remove("dark-mode");
        }

        // Apply CSS variables (matching project's existing CSS variable names)
        root.style.setProperty("--primary-color", themeColors.primary);
        root.style.setProperty("--secondary-color", themeColors.secondary);
        root.style.setProperty("--bg-color", themeColors.background);
        root.style.setProperty("--content-bg", themeColors.surface);
        root.style.setProperty("--text-color", themeColors.text);
        root.style.setProperty(
            "--text-secondary-color",
            themeColors.textSecondary,
        );
        root.style.setProperty("--border-color", themeColors.border);
        root.style.setProperty("--primary-text-color", primaryTextColor);
        root.style.setProperty("--secondary-text-color", secondaryTextColor);

        // Generate hover colors
        root.style.setProperty(
            "--primary-dark",
            darkenColor(themeColors.primary, 10),
        );
        root.style.setProperty(
            "--secondary-light",
            darkenColor(themeColors.secondary, 10),
        );
    }, [config, resolvedMode, themeMode, accessibility]);

    // Helper function to darken a color
    function darkenColor(hex, percent) {
        if (!hex) return hex;
        const c = hex.replace("#", "");
        if (c.length !== 6) return hex;
        const num = parseInt(c, 16);
        const amt = Math.round(2.55 * percent);
        let r = (num >> 16) - amt;
        let g = ((num >> 8) & 0x00ff) - amt;
        let b = (num & 0x0000ff) - amt;
        r = Math.max(0, r);
        g = Math.max(0, g);
        b = Math.max(0, b);
        return (
            "#" +
            (
                0x1000000 +
                (r < 255 ? (r < 1 ? 0 : r) : 255) * 0x10000 +
                (g < 255 ? (g < 1 ? 0 : g) : 255) * 0x100 +
                (b < 255 ? (b < 1 ? 0 : b) : 255)
            )
                .toString(16)
                .slice(1)
        );
    }

    // Helper function to lighten a color
    function lightenColor(hex, percent) {
        if (!hex) return hex;
        const c = hex.replace("#", "");
        if (c.length !== 6) return hex;
        const num = parseInt(c, 16);
        const amt = Math.round(2.55 * percent);
        let r = (num >> 16) + amt;
        let g = ((num >> 8) & 0x00ff) + amt;
        let b = (num & 0x0000ff) + amt;
        r = Math.min(255, r);
        g = Math.min(255, g);
        b = Math.min(255, b);
        return (
            "#" +
            (0x1000000 + r * 0x10000 + g * 0x100 + b).toString(16).slice(1)
        );
    }

    const updateSettings = async (newSettings) => {
        // Update local state
        setConfig((prev) => ({
            ...prev,
            ...newSettings,
        }));

        // Convert nested settings to flat key-value pairs
        const flatSettings = [];
        const flattenObject = (obj, prefix = "") => {
            for (const key in obj) {
                const fullKey = prefix ? `${prefix}.${key}` : key;
                if (
                    typeof obj[key] === "object" &&
                    obj[key] !== null &&
                    !Array.isArray(obj[key])
                ) {
                    flattenObject(obj[key], fullKey);
                } else {
                    flatSettings.push({ key: fullKey, value: obj[key] });
                }
            }
        };
        flattenObject(newSettings);

        // Save to API
        const token = localStorage.getItem("accessToken");
        if (!token) return;

        try {
            const res = await fetch("/api/settings", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({ settings: flatSettings }),
            });
            if (!res.ok) throw new Error("Failed to save settings");
        } catch (err) {
            console.error("Error saving settings:", err);
        }
    };

    // Persistent filter storage
    const getPersistentFilter = (key) => {
        try {
            const saved = localStorage.getItem(`filter_${key}`);
            return saved ? JSON.parse(saved) : null;
        } catch {
            return null;
        }
    };

    const setPersistentFilter = (key, value) => {
        try {
            localStorage.setItem(`filter_${key}`, JSON.stringify(value));
        } catch (err) {
            console.error("Error saving filter:", err);
        }
    };

    // Get label by key (singular or plural)
    const getLabel = (key) => {
        const value = config?.labels?.[key] || defaultLabels[key] || key;
        return value;
    };

    // Get gender-specific helpers for a label key
    const getGenderHelpers = (baseKey) => {
        let gender = config?.labels?.[`${baseKey}_gender`] || "M";

        // Handle singular label key (client, agreement, etc.)
        if (
            baseKey === "client" ||
            baseKey === "agreement" ||
            baseKey === "category" ||
            baseKey === "subcategory" ||
            baseKey === "affiliate" ||
            baseKey === "user"
        ) {
            const value = getLabel(baseKey);
            if (gender === "M") {
                return {
                    label: value,
                    article: "o",
                    articleUpper: "O",
                    new: "Novo",
                    none: "Nenhum",
                    found: "encontrado",
                    all: "Todos",
                    active: "
