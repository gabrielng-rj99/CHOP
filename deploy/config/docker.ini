
# ============================================================================
# IMPORTANT: PASSWORD CONFIGURATION NOTICE
# ============================================================================
# The database password (DB_PASSWORD) and JWT secret (JWT_SECRET) will be
# configured in the next step of the deployment process.
#
# DO NOT set them here - they will be generated securely and injected
# during the docker-compose.yml generation.
# ============================================================================

# ============================================================================
# DOCKER DEPLOYMENT CONFIGURATION
# ============================================================================
# This file is the single source of truth for Docker deployment settings.
# The Deploy Manager uses this file to generate docker-compose.yml dynamically.
#
# DO NOT add .env files - all configuration comes from this INI file.
# DO NOT edit docker-compose.yml directly - it's auto-generated.
#
# Changes here require restarting services:
#   deploy stop
#   deploy start

[docker]
# Container names
postgres_container = opengeneric_postgres
backend_container = opengeneric_backend
frontend_container = opengeneric_frontend

# Docker network
network_name = opengeneric-network
compose_file = deploy/config/docker-compose.yml
postgres_volume = opengeneric_postgres_data

# Port mapping: HOST:CONTAINER
# Container ports are fixed, host ports are configurable
backend_host_port = 3000
backend_container_port = 3000

frontend_host_port = 8080
frontend_container_port = 80

postgres_host_port = 5432

# Port exposure control
# Set to true to expose on host (localhost:PORT)
# Set to false to keep internal to Docker network only (no host access)
expose_backend_port = true
expose_frontend_port = true
expose_postgres_port = true

[database]
container_name = ${postgres_container}
host = postgres
port = 5432
name = appdb
user = appuser
password = apppass
ssl_mode = disable
max_open_conns = 10
max_idle_conns = 5
conn_max_lifetime = 180

[server]
host = 0.0.0.0
port = ${backend_container_port}
request_timeout = 30
read_timeout = 15
write_timeout = 15
idle_timeout = 60
cors_allowed_origins = http://localhost:${frontend_host_port},http://localhost:5173,http://frontend
cors_allowed_methods = GET,POST,PUT,DELETE,OPTIONS,PATCH
cors_allowed_headers = Content-Type,Authorization,X-Requested-With
cors_expose_headers = Content-Length,X-Total-Count
cors_allow_credentials = true
cors_max_age = 3600

[jwt]
# JWT configuration for authentication
secret = change_me_in_production_min_32_chars
expiration_time = 60
refresh_expiration_time = 10080
algorithm = HS256

[logging]
enabled = true
level = info
format = json
file = logs/app.log
max_size = 5
max_backups = 3
max_age = 30

[security]
password_min_length = 16
password_require_uppercase = true
password_require_lowercase = true
password_require_numbers = true
password_require_special = true
max_failed_attempts = 5
lockout_duration_minutes = 30
lock_levels = 3
lock_level_1_attempts = 3
lock_level_1_duration_minutes = 5
lock_level_2_attempts = 5
lock_level_2_duration_minutes = 15
lock_level_3_attempts = 8
lock_level_3_duration_minutes = 60
lock_level_manual_attempts = 10

[application]
env = docker
version = 1.0.0
name = Open-Generic-Hub

[paths]
schema_file = ./backend/database/schema.sql
migrations_dir = ./backend/migrations
logs_dir = ./backend/logs
reports_dir = ./backend/reports

[services]
postgres_container = ${postgres_container}
backend_container = ${backend_container}
frontend_container = ${frontend_container}
backend_health_endpoint = /health
backend_health_timeout = 30
database_healthcheck_user = ${database:user}
frontend_health_path = /health
